num_n, num_l
Iter:   0, Energy:  231.34506, Int:  239.40804, Ext:    8.06297, Eval loss:  194.80048, Loss_change: 231.34506
Iter:   1, Energy:   12.07961, Int:   22.45400, Ext:   10.37440, Eval loss:    9.07482, Loss_change: 219.26546
Iter:   2, Energy:   -1.03178, Int:    7.35674, Ext:    8.38852, Eval loss:   -2.50998, Loss_change: 13.11138
Iter:   3, Energy:   -4.95011, Int:    4.60786, Ext:    9.55797, Eval loss:   -5.79866, Loss_change:  3.91833
Iter:   4, Energy:   -5.90938, Int:    5.87417, Ext:   11.78355, Eval loss:   -6.95123, Loss_change:  0.95927
Iter:   5, Energy:   -6.45710, Int:    6.13332, Ext:   12.59042, Eval loss:   -7.60519, Loss_change:  0.54772
Iter:   6, Energy:   -6.70484, Int:    6.28523, Ext:   12.99007, Eval loss:   -7.94213, Loss_change:  0.24774
Iter:   7, Energy:   -6.85197, Int:    6.47448, Ext:   13.32646, Eval loss:   -8.14173, Loss_change:  0.14713
Iter:   8, Energy:   -6.92741, Int:    6.20774, Ext:   13.13515, Eval loss:   -8.14461, Loss_change:  0.07544
Iter:   9, Energy:   -7.00304, Int:    6.25665, Ext:   13.25969, Eval loss:   -8.23727, Loss_change:  0.07563
Iter:  10, Energy:   -7.06003, Int:    6.52919, Ext:   13.58923, Eval loss:   -8.36179, Loss_change:  0.05699
Iter:  11, Energy:   -7.11350, Int:    6.68232, Ext:   13.79582, Eval loss:   -8.42731, Loss_change:  0.05347
Iter:  12, Energy:   -7.16808, Int:    6.39933, Ext:   13.56741, Eval loss:   -8.37772, Loss_change:  0.05457
Iter:  13, Energy:   -7.21140, Int:    6.20530, Ext:   13.41670, Eval loss:   -8.36541, Loss_change:  0.04332
Iter:  14, Energy:   -7.24995, Int:    6.45247, Ext:   13.70243, Eval loss:   -8.45721, Loss_change:  0.03856
Iter:  15, Energy:   -7.28156, Int:    6.58702, Ext:   13.86858, Eval loss:   -8.51740, Loss_change:  0.03161
Iter:  16, Energy:   -7.31538, Int:    6.46156, Ext:   13.77694, Eval loss:   -8.52431, Loss_change:  0.03382
Traceback (most recent call last):
  File "/itf-fi-ml/home/mansurd/Master/3DBeam/DemBeam3D.py", line 408, in <module>
    U_norms_i, losses_i = train_and_evaluate(Ns=N, lrs=lr, num_neurons=num_neurons, num_layers=num_layers, num_epochs=num_epochs, shape=shape, eval_data=[x_eval, y_eval, z_eval], k=1)
  File "/itf-fi-ml/home/mansurd/Master/3DBeam/DemBeam3D.py", line 290, in train_and_evaluate
    DemBeam.train_model(domain, dirichlet, neumann, shape, LHD, lr=lrs, max_it=max_it, epochs=num_epochs, eval_data=eval_data, k=k)
  File "/itf-fi-ml/home/mansurd/Master/3DBeam/../DEM.py", line 130, in train_model
    eval_internal = self.energy(u_eval, xyz_eval)
  File "/itf-fi-ml/home/mansurd/Master/3DBeam/DemBeam3D.py", line 118, in energy
    duzdxyz = grad(u[:, 2].unsqueeze(1), x, torch.ones(x.shape[0], 1, device=dev), create_graph=True, retain_graph=True)[0]
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/__init__.py", line 276, in grad
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
