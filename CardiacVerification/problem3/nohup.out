/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in MulBackward0. Traceback of forward call that caused the error:
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/problem3.py", line 171, in <module>
    DemLV.train_model(domain, dirichlet, neumann, shape=shape, LHD=None,
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../DEM.py", line 136, in train_model
    optimizer.step(closure)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/optim/optimizer.py", line 109, in wrapper
    return func(*args, **kwargs)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/optim/lbfgs.py", line 311, in step
    orig_loss = closure()
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../DEM.py", line 103, in closure
    IntEnergy = self.energy(u_pred, self.x)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../EnergyModels.py", line 273, in __call__
    detF, Q, I4f0 = self._get_invariants(u, x)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../EnergyModels.py", line 260, in _get_invariants
    detF, Q = super()._get_invariants(u, x)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../EnergyModels.py", line 203, in _get_invariants
    detF, _ = super()._get_invariants(u, x)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../EnergyModels.py", line 165, in _get_invariants
    Ezz = 0.5*(Czz - 1)
 (Triggered internally at  /dev/shm/PyTorch/1.12.0/foss-2022a-CUDA-11.7.0/pytorch/torch/csrc/autograd/python_anomaly_mode.cpp:102.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Running on GPU
cuda
Traceback (most recent call last):
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/problem3.py", line 171, in <module>
    DemLV.train_model(domain, dirichlet, neumann, shape=shape, LHD=None, 
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../DEM.py", line 136, in train_model
    optimizer.step(closure)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/optim/optimizer.py", line 109, in wrapper
    return func(*args, **kwargs)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/optim/lbfgs.py", line 311, in step
    orig_loss = closure()
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/itf-fi-ml/home/mansurd/Master/CardiacVerification/problem3/../../DEM.py", line 126, in closure
    loss.backward()
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/storage/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'MulBackward0' returned nan values in its 0th output.
